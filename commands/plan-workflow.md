---
description: 开启工作时的标准流程：配置项目、阅读文档、盘点进度、生成待执行任务
---

# 开发工作流

此工作流定义如何开启工作和工作交付内容。

## 交付原则

- 只需要交付重点文字和"输出产物"即可，不需要提供其他额外的理解文字
- 若第一步完成后，应同时交付所有"输出产物"（第二、三和补充步骤）
- 只有第一步需要用户介入，其他步骤不需要且应该直接进行交付，无需给用户过多信息

---

## 零：项目配置（首次使用时）

### 触发条件
在项目根目录下检查是否存在 `.cursor/workflow-config.json` 配置文件：
- 若**不存在**：执行首次配置流程
- 若**已存在**：跳过此步骤，直接进入第一步

### 首次配置流程

向用户询问以下信息（使用选项或填空方式）：

#### 1. 策划案/设计文档地址
```
请提供项目的策划案或设计文档所在目录：
例如：Docs/Design 或 specs/

输入路径：_______
```

#### 2. 输出文档存放地址
```
请提供 AI 生成文档的存放目录：
例如：Docs/AI 或 output/

输入路径：_______
```

#### 3. 项目规范文档地址（可选）
```
项目是否有自己的开发规范文档？
  [1] 是，提供路径：_______
  [2] 否，使用内置规范

如果选择 [1]，请确保目录下包含：
  - C# 代码规范文档（命名、注释等）
  - 开发流程规范文档（设计、测试等）
```

### 配置文件格式

完成配置后，在 `.cursor/` 目录生成 `workflow-config.json`：

```json
{
  "version": "1.0",
  "paths": {
    "designDocs": "用户提供的策划案路径",
    "outputDocs": "用户提供的输出文档路径",
    "standards": "用户提供的规范路径 或 null"
  },
  "useBuiltinStandards": true/false,
  "createdAt": "2025-01-01T00:00:00Z"
}
```

### 内置规范说明

若用户选择使用内置规范，则参考以下文档：
- **C# 代码规范**：`standards/csharp-coding-standard.md`（仓库内置）
- **开发流程规范**：`standards/development-standard.md`（仓库内置）

这些内置规范已随本工具安装到 `.cursor/standards/` 目录。

---

## 一：阅读项目文档并盘点开发进度

### 范围
根据配置文件中的 `paths.designDocs` 路径阅读项目相关文档。先框架底层，再业务逻辑。

### 输出产物
在配置的 `paths.outputDocs` 目录生成 `development_progress.md`，详细记录当前开发进度、已有接口与功能、完成状态。

### 优先级规则
1. 无任何依赖的任务优先
2. 其次是少数依赖且依赖已存在的任务
3. 再次是多数依赖且依赖已存在的任务
4. 若依赖项不存在，应先等待依赖完成后再继续

### 进度表格式

| 系统/功能 | 关键接口 | 当前状态 | 负责人 | 依赖项 | 备注 |
|----------|---------|---------|-------|-------|------|

将文件保存至：`{paths.outputDocs}/development_progress.md`

### 检查开发进度表
- 若表中不存在进行中的任务，应直接开启下一步
- 若表中存在已进行中的任务，应先在其 spec 任务中查看 `task.md` 是否已完成
  - 若都已完成，修改开发进度文档并进行下一步
  - 若存在未完成，应告知用户，咨询是否继续执行未完成任务后再开启下一步（使用选项让用户选择）

---

## 二：生成当前待执行任务

### 粒度
以"系统"或"功能"为单位列出任务。一次只生成一个待执行任务。

### 资料来源
根据当前的任务在 `{paths.designDocs}` 查找相关的策划文档与设计文档。

### 整理诉求
从文档中提炼技术需求与产品需求，形成清晰的"诉求"。

### 输出产物

```
/speckit.specify 请为项目开发一个{系统/功能名称}，{诉求}，关键文档与上下文见：{参考文档}。请确保完全了解需要开发需求后再执行。文档用中文撰写。
```

---

## 三：制定实现计划

### 规范与技术栈

根据配置读取规范文档：
- 若 `useBuiltinStandards: true`：阅读 `.cursor/standards/` 下的内置规范
- 若 `useBuiltinStandards: false`：阅读 `{paths.standards}` 下的项目规范

### 输出产物
将以上信息整理为"计划文档"，以及关键的参考文档。

### 输出格式

```
/speckit.plan {计划文档}，关键文档与上下文见：{参考文档}。请确保完全了解需要开发需求后再执行。文档用中文进行撰写。
```

---

## 补充步骤

### 澄清阶段（可选）
会有一些系统或功能存在模糊不清的领域，需要在 plan 前进行 `/speckit.clarify` 步骤，用于澄清细节和提出结构化问题。

### 质量检查
在 plan 执行后，执行 `/speckit.checklist` 验证生成质量检查表，用于验证需求的完整性、清晰度和一致性。

### 任务生成与执行
完成后执行：
- `/speckit.tasks` - 生成具体任务
- `/speckit.implement` - 执行任务

---

## 配置管理命令

### 重新配置
如需重新配置项目路径，可删除 `.cursor/workflow-config.json` 后重新运行本命令，或直接编辑该配置文件。

### 配置示例

**示例 1：使用项目自有规范**
```json
{
  "version": "1.0",
  "paths": {
    "designDocs": "Docs/Design",
    "outputDocs": "Docs/AI",
    "standards": "Docs/Standards"
  },
  "useBuiltinStandards": false,
  "createdAt": "2025-01-01T00:00:00Z"
}
```

**示例 2：使用内置规范**
```json
{
  "version": "1.0",
  "paths": {
    "designDocs": "specs/features",
    "outputDocs": "output/ai-docs",
    "standards": null
  },
  "useBuiltinStandards": true,
  "createdAt": "2025-01-01T00:00:00Z"
}
```
